
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module CSIntel</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>CSIntel</strong></big></big> (version 0.3)</font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/Users/adam/Documents/python/API/CS/Intel/prod/CSIntel.py">/Users/adam/Documents/python/API/CS/Intel/prod/CSIntel.py</a></font></td></tr></table>
    <p><tt>This&nbsp;file&nbsp;will&nbsp;act&nbsp;as&nbsp;a&nbsp;Python&nbsp;API&nbsp;for&nbsp;CrowdStrike's&nbsp;Threat&nbsp;Intelligence&nbsp;API.&nbsp;It&nbsp;was&nbsp;built&nbsp;to&nbsp;make&nbsp;it<br>
easy&nbsp;to&nbsp;use&nbsp;the&nbsp;Intel&nbsp;API.&nbsp;<br>
&nbsp;<br>
This&nbsp;module&nbsp;can&nbsp;be&nbsp;used&nbsp;one&nbsp;of&nbsp;two&nbsp;ways:&nbsp;by&nbsp;executing&nbsp;it&nbsp;directly&nbsp;from&nbsp;the&nbsp;command&nbsp;line&nbsp;or&nbsp;by&nbsp;importing&nbsp;<br>
it&nbsp;into&nbsp;another&nbsp;script.&nbsp;<br>
&nbsp;<br>
Example&nbsp;1:&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;$&gt;&nbsp;./CSIntel.py&nbsp;--custid&nbsp;ABC&nbsp;--custkey&nbsp;DEF&nbsp;--day&nbsp;--indicators<br>
&nbsp;<br>
Example&nbsp;2:<br>
&nbsp;&nbsp;&nbsp;&nbsp;#!/usr/bin/python<br>
&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;CSIntel<br>
&nbsp;&nbsp;&nbsp;&nbsp;api_obj&nbsp;=&nbsp;CSIntel.<a href="#CSIntelAPI">CSIntelAPI</a>(custid,&nbsp;custkey)<br>
&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;=&nbsp;api_obj.SearchLastWeek()<br>
&nbsp;<br>
To&nbsp;learn&nbsp;more&nbsp;about&nbsp;the&nbsp;functions&nbsp;you&nbsp;can&nbsp;use&nbsp;when&nbsp;importing&nbsp;this&nbsp;file&nbsp;see&nbsp;the&nbsp;included&nbsp;python<br>
documentation:<br>
&nbsp;&nbsp;&nbsp;&nbsp;$&gt;&nbsp;pydoc&nbsp;./CSIntel.py<br>
&nbsp;<br>
You&nbsp;can&nbsp;also&nbsp;see&nbsp;the&nbsp;examples&nbsp;included&nbsp;within&nbsp;for&nbsp;the&nbsp;simple&nbsp;functions&nbsp;that&nbsp;are&nbsp;used&nbsp;to&nbsp;enable<br>
the&nbsp;CLI&nbsp;commands.<br>
&nbsp;<br>
The&nbsp;command&nbsp;line&nbsp;usage&nbsp;is&nbsp;shown&nbsp;below:<br>
&nbsp;<br>
-------------------------------------------------------------------------------------------------------<br>
usage:&nbsp;CSIntel.py&nbsp;[-h]&nbsp;[--custid&nbsp;CUSTID]&nbsp;[--custkey&nbsp;CUSTKEY]&nbsp;[--write]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[--config&nbsp;CONFIG]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(--actor&nbsp;ACTOR&nbsp;|&nbsp;--actors&nbsp;ACTORS&nbsp;|&nbsp;--ip&nbsp;IP&nbsp;|&nbsp;--indicator&nbsp;INDICATOR&nbsp;|&nbsp;--day&nbsp;|&nbsp;--week)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[--out&nbsp;{all,indicators,hashes,domains,ips,actors,reports}]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[--related]<br>
&nbsp;<br>
CS&nbsp;Intel&nbsp;API<br>
&nbsp;<br>
optional&nbsp;arguments:<br>
&nbsp;&nbsp;-h,&nbsp;--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show&nbsp;this&nbsp;help&nbsp;message&nbsp;and&nbsp;exit<br>
&nbsp;&nbsp;--custid&nbsp;CUSTID,&nbsp;-i&nbsp;CUSTID<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;API&nbsp;Customer&nbsp;ID<br>
&nbsp;&nbsp;--custkey&nbsp;CUSTKEY,&nbsp;-k&nbsp;CUSTKEY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;API&nbsp;Customer&nbsp;Key<br>
&nbsp;&nbsp;--write,&nbsp;-w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write&nbsp;the&nbsp;API&nbsp;config&nbsp;to&nbsp;the&nbsp;file&nbsp;specified&nbsp;by&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--config&nbsp;option<br>
&nbsp;&nbsp;--config&nbsp;CONFIG,&nbsp;-c&nbsp;CONFIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Configuration&nbsp;File&nbsp;Name<br>
&nbsp;&nbsp;--actor&nbsp;ACTOR,&nbsp;-a&nbsp;ACTOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;an&nbsp;actor&nbsp;by&nbsp;name<br>
&nbsp;&nbsp;--actors&nbsp;ACTORS,&nbsp;-s&nbsp;ACTORS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;a&nbsp;actors&nbsp;by&nbsp;pattern<br>
&nbsp;&nbsp;--ip&nbsp;IP,&nbsp;-p&nbsp;IP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;an&nbsp;IP&nbsp;address<br>
&nbsp;&nbsp;--domain&nbsp;DOMAIN,&nbsp;-d&nbsp;DOMAIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;a&nbsp;domain<br>
&nbsp;&nbsp;--report&nbsp;REPORT,&nbsp;-r&nbsp;REPORT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;a&nbsp;report<br>
&nbsp;&nbsp;--indicator&nbsp;INDICATOR,&nbsp;-n&nbsp;INDICATOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search&nbsp;for&nbsp;an&nbsp;indicator<br>
&nbsp;&nbsp;--day&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get&nbsp;all&nbsp;indicators&nbsp;that&nbsp;have&nbsp;changed&nbsp;in&nbsp;24&nbsp;hours<br>
&nbsp;&nbsp;--week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get&nbsp;all&nbsp;indicators&nbsp;that&nbsp;have&nbsp;changed&nbsp;in&nbsp;the&nbsp;past&nbsp;week<br>
&nbsp;&nbsp;--out&nbsp;{all,indicators,hashes,domains,ips,actors,reports},&nbsp;-o&nbsp;{all,indicators,hashes,domains,ips,actors,reports}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;should&nbsp;I&nbsp;print?&nbsp;Default:&nbsp;all<br>
&nbsp;&nbsp;--related&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Include&nbsp;related&nbsp;indicators.<br>
-------------------------------------------------------------------------------------------------------<br>
&nbsp;<br>
Using&nbsp;from&nbsp;the&nbsp;Command&nbsp;Line<br>
-------<br>
&nbsp;<br>
The&nbsp;first&nbsp;step&nbsp;to&nbsp;using&nbsp;this&nbsp;from&nbsp;the&nbsp;Command&nbsp;Line&nbsp;is&nbsp;to&nbsp;make&nbsp;sure&nbsp;you're&nbsp;passing&nbsp;your&nbsp;Customer&nbsp;ID<br>
and&nbsp;your&nbsp;Customer&nbsp;Key.&nbsp;There&nbsp;are&nbsp;two&nbsp;ways&nbsp;you&nbsp;can&nbsp;do&nbsp;this:<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;A)&nbsp;Pass&nbsp;your&nbsp;Customer&nbsp;ID&nbsp;and&nbsp;Key&nbsp;from&nbsp;the&nbsp;command&nbsp;line:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&gt;&nbsp;./CSintel.py&nbsp;--custid&nbsp;&lt;Customer&nbsp;ID&gt;&nbsp;--custkey&nbsp;&lt;Customer&nbsp;Key&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;B)&nbsp;Place&nbsp;your&nbsp;Customer&nbsp;ID&nbsp;and&nbsp;Key&nbsp;in&nbsp;a&nbsp;config&nbsp;file&nbsp;to&nbsp;be&nbsp;read&nbsp;by&nbsp;the&nbsp;script.&nbsp;By&nbsp;default&nbsp;the&nbsp;file<br>
&nbsp;&nbsp;&nbsp;&nbsp;expected&nbsp;is&nbsp;csintel.ini<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;create&nbsp;this&nbsp;config&nbsp;file&nbsp;you&nbsp;can&nbsp;either&nbsp;write&nbsp;it&nbsp;explicitly&nbsp;or&nbsp;save&nbsp;the&nbsp;config&nbsp;from&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;command&nbsp;line&nbsp;executation.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&gt;&nbsp;./CSintel.py&nbsp;--custid&nbsp;ABCD&nbsp;--custkey&nbsp;EFGH&nbsp;--write&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;will&nbsp;save&nbsp;Customer&nbsp;ID&nbsp;&amp;&nbsp;Key&nbsp;to&nbsp;the&nbsp;default&nbsp;config&nbsp;file&nbsp;(csintel.ini).&nbsp;If&nbsp;you&nbsp;wish&nbsp;to&nbsp;specify<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;different&nbsp;file&nbsp;you&nbsp;can&nbsp;pass&nbsp;that:&nbsp;--write&nbsp;--config&nbsp;diffFile.ini<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;manually&nbsp;write&nbsp;the&nbsp;config&nbsp;file&nbsp;it&nbsp;follows&nbsp;this&nbsp;layout:<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[CrowdStrikeIntelAPI]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custid&nbsp;=&nbsp;ABCD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custkey&nbsp;=&nbsp;EFGH<br>
&nbsp;<br>
Once&nbsp;you&nbsp;are&nbsp;setup&nbsp;to&nbsp;pass&nbsp;your&nbsp;Customer&nbsp;ID&nbsp;and&nbsp;Key&nbsp;you&nbsp;can&nbsp;start&nbsp;searching&nbsp;the&nbsp;Threat&nbsp;Intel&nbsp;API.&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;--actor<br>
&nbsp;&nbsp;&nbsp;&nbsp;--actors<br>
&nbsp;&nbsp;&nbsp;&nbsp;--ip<br>
&nbsp;&nbsp;&nbsp;&nbsp;--domain<br>
&nbsp;&nbsp;&nbsp;&nbsp;--report<br>
&nbsp;&nbsp;&nbsp;&nbsp;--indicator<br>
&nbsp;&nbsp;&nbsp;&nbsp;--day<br>
&nbsp;&nbsp;&nbsp;&nbsp;--week<br>
&nbsp;<br>
You&nbsp;can&nbsp;also&nbsp;specify&nbsp;what&nbsp;output&nbsp;you&nbsp;want&nbsp;to&nbsp;receive.&nbsp;By&nbsp;default&nbsp;these&nbsp;methods&nbsp;will&nbsp;pretty&nbsp;print&nbsp;all<br>
JSON&nbsp;received&nbsp;from&nbsp;the&nbsp;API&nbsp;request.&nbsp;Altenatively&nbsp;you&nbsp;can&nbsp;specify:<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;--out&nbsp;indicators&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-print&nbsp;all&nbsp;indicators<br>
&nbsp;&nbsp;&nbsp;&nbsp;--out&nbsp;hashes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-print&nbsp;just&nbsp;the&nbsp;hashes<br>
&nbsp;&nbsp;&nbsp;&nbsp;--out&nbsp;domains&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-print&nbsp;just&nbsp;domains<br>
&nbsp;&nbsp;&nbsp;&nbsp;--out&nbsp;ips&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-print&nbsp;just&nbsp;IP&nbsp;addresses<br>
&nbsp;&nbsp;&nbsp;&nbsp;--out&nbsp;actors&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-print&nbsp;any&nbsp;Actors&nbsp;associated&nbsp;with&nbsp;the&nbsp;API&nbsp;request&nbsp;data<br>
&nbsp;&nbsp;&nbsp;&nbsp;--out&nbsp;reports&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-print&nbsp;any&nbsp;reports&nbsp;associated&nbsp;with&nbsp;the&nbsp;API&nbsp;request&nbsp;data<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
Examples<br>
==========<br>
&nbsp;<br>
Tell&nbsp;me&nbsp;about&nbsp;Rocket&nbsp;Kitten.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;./CSIntel.py&nbsp;--actor&nbsp;rocketkitten<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;<br>
Get&nbsp;all&nbsp;intel&nbsp;data&nbsp;that&nbsp;has&nbsp;been&nbsp;updated&nbsp;in&nbsp;the&nbsp;last&nbsp;24&nbsp;hours&nbsp;and&nbsp;print&nbsp;all&nbsp;indicators&nbsp;returned<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;./CSIntel.py&nbsp;--day&nbsp;--out&nbsp;indicators<br>
&nbsp;&nbsp;&nbsp;&nbsp;hash_md5:297bea792870a2433944a1ea8bcaf196:Malware/njRAT:MaliciousConfidence/High:<br>
&nbsp;&nbsp;&nbsp;&nbsp;hash_md5:df12de91be850692e24dc6b9ea3f4645:Malware/njRAT:MaliciousConfidence/High:<br>
&nbsp;&nbsp;&nbsp;&nbsp;hash_sha1:3b9dde2478c42576f87506dfe0aeca921dd42a0f:Malware/njRAT:MaliciousConfidence/High:<br>
&nbsp;&nbsp;&nbsp;&nbsp;hash_sha1:4952afe964e304a4ab74158b1bf84e1e74ef05cb:Malware/njRAT:MaliciousConfidence/High:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ip_address:178.67.252.5:ThreatType/Suspicious:IpAddressType/TorProxy:<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;<br>
Having&nbsp;found&nbsp;an&nbsp;interesting&nbsp;IP&nbsp;address,&nbsp;search&nbsp;CrowdStrike's&nbsp;API&nbsp;for&nbsp;it&nbsp;and&nbsp;return&nbsp;if&nbsp;any&nbsp;threat<br>
actors&nbsp;have&nbsp;been&nbsp;associated&nbsp;with&nbsp;it.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;./CSIntel.py&nbsp;--ip&nbsp;211.230.232.221&nbsp;--out&nbsp;actors<br>
&nbsp;&nbsp;&nbsp;&nbsp;WETPANDA<br>
&nbsp;<br>
Search&nbsp;the&nbsp;same&nbsp;IP&nbsp;address&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;has&nbsp;been&nbsp;discussed&nbsp;in&nbsp;any&nbsp;Intelligence&nbsp;Reports.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;./CSIntel.py&nbsp;--ip&nbsp;211.230.232.221&nbsp;--out&nbsp;reports<br>
&nbsp;&nbsp;&nbsp;&nbsp;CSIR-13017<br>
&nbsp;&nbsp;&nbsp;&nbsp;CSIT-13051<br>
&nbsp;<br>
Search&nbsp;a&nbsp;specified&nbsp;report&nbsp;and&nbsp;print&nbsp;all&nbsp;hashes&nbsp;associated&nbsp;with&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&gt;./CSIntel.py&nbsp;&nbsp;--report&nbsp;CSIR-13017&nbsp;--out&nbsp;hashes<br>
&nbsp;&nbsp;&nbsp;&nbsp;f4971892bdedbff4aa0cc8c63fcf85f2c8bfe364d76769cadd70d128a372a481<br>
&nbsp;&nbsp;&nbsp;&nbsp;63dbabdf27f92b29597ea4fbeacb1d7fde058d8d<br>
&nbsp;&nbsp;&nbsp;&nbsp;391b63a12332cdb7384d4183c8693153c683ed8afd6a8933b87a1eea88cb107a<br>
&nbsp;&nbsp;&nbsp;&nbsp;6ce07e229a91953410ae972343d14e9d9a2afbe1<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
-------------------------------------------------------------------------------------------------------<br>
written&nbsp;by:&nbsp;adam.hogan@crowdstrike.com<br>
&nbsp;<br>
Change&nbsp;log<br>
=========<br>
&nbsp;<br>
Version&nbsp;0.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Added&nbsp;search&nbsp;for&nbsp;report&nbsp;name<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Added&nbsp;documentation&nbsp;examples<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Cleaned&nbsp;up&nbsp;config&nbsp;write<br>
Version&nbsp;0.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Added&nbsp;indicator&nbsp;labels&nbsp;option,&nbsp;and&nbsp;it's&nbsp;availability&nbsp;from&nbsp;the&nbsp;CLI<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Added&nbsp;"related"&nbsp;options&nbsp;to&nbsp;data&nbsp;methods&nbsp;to&nbsp;get&nbsp;indicators&nbsp;related&nbsp;to&nbsp;the&nbsp;original&nbsp;indicators.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Also&nbsp;available&nbsp;from&nbsp;the&nbsp;Command&nbsp;Line&nbsp;with&nbsp;the&nbsp;--related&nbsp;flag.<br>
Version&nbsp;0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Initial&nbsp;release<br>
&nbsp;<br>
&nbsp;<br>
TODO<br>
&nbsp;&nbsp;&nbsp;&nbsp;*search&nbsp;for&nbsp;malware&nbsp;family<br>
&nbsp;&nbsp;&nbsp;&nbsp;*search&nbsp;for&nbsp;labels<br>
&nbsp;&nbsp;&nbsp;&nbsp;*search&nbsp;for&nbsp;target&nbsp;industry<br>
&nbsp;&nbsp;&nbsp;&nbsp;*search&nbsp;for&nbsp;threat&nbsp;type<br>
&nbsp;&nbsp;&nbsp;&nbsp;*search&nbsp;by&nbsp;vulnerability<br>
&nbsp;&nbsp;&nbsp;&nbsp;*input&nbsp;validating<br>
&nbsp;&nbsp;&nbsp;&nbsp;*error&nbsp;control<br>
&nbsp;&nbsp;&nbsp;&nbsp;*add&nbsp;proxy&nbsp;server&nbsp;support<br>
-------------------------------------------------------------------------------------------------------</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="requests.html">requests</a><br>
</td><td width="25%" valign=top></td><td width="25%" valign=top></td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ee77aa">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font></td></tr>
    
<tr><td bgcolor="#ee77aa"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl>
<dt><font face="helvetica, arial"><a href="CSIntel.html#CSIntelAPI">CSIntelAPI</a>
</font></dt></dl>
 <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="CSIntelAPI">class <strong>CSIntelAPI</strong></a></font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt>Class&nbsp;for&nbsp;interacting&nbsp;with&nbsp;CrowdStrike&nbsp;Intel&nbsp;API<br>
&nbsp;<br>
This&nbsp;class&nbsp;object&nbsp;is&nbsp;used&nbsp;in&nbsp;this&nbsp;program&nbsp;if&nbsp;called&nbsp;directly&nbsp;or&nbsp;can&nbsp;be&nbsp;imported<br>
into&nbsp;another&nbsp;script&nbsp;to&nbsp;use&nbsp;it's&nbsp;methods&nbsp;to&nbsp;search&nbsp;the&nbsp;threat&nbsp;intel&nbsp;API&nbsp;and&nbsp;process<br>
the&nbsp;data&nbsp;returned.&nbsp;<br>
&nbsp;<br>
Check&nbsp;out&nbsp;functions&nbsp;that&nbsp;start&nbsp;with&nbsp;Search*&nbsp;to&nbsp;see&nbsp;different&nbsp;methods&nbsp;of&nbsp;pulling&nbsp;data.<br>
&nbsp;<br>
Check&nbsp;out&nbsp;functions&nbsp;that&nbsp;like&nbsp;Get*FromResults&nbsp;to&nbsp;see&nbsp;different&nbsp;exampels&nbsp;of&nbsp;processing<br>
the&nbsp;JSON&nbsp;data&nbsp;that&nbsp;is&nbsp;returned&nbsp;from&nbsp;an&nbsp;API&nbsp;search.&nbsp;<br>
&nbsp;<br>
To&nbsp;create&nbsp;this&nbsp;object&nbsp;you&nbsp;need&nbsp;to&nbsp;pass&nbsp;your&nbsp;Customer&nbsp;ID&nbsp;and&nbsp;Cutomer&nbsp;Key.&nbsp;If&nbsp;you're<br>
going&nbsp;to&nbsp;be&nbsp;reusing&nbsp;this&nbsp;at&nbsp;all&nbsp;it&nbsp;is&nbsp;much&nbsp;faster&nbsp;to&nbsp;add&nbsp;your&nbsp;ID&nbsp;&amp;&nbsp;Key&nbsp;to&nbsp;a&nbsp;config<br>
file&nbsp;to&nbsp;be&nbsp;read&nbsp;by&nbsp;this&nbsp;script.&nbsp;The&nbsp;default&nbsp;config&nbsp;file&nbsp;is&nbsp;./csintel.ini.<br>
&nbsp;<br>
If&nbsp;you&nbsp;have&nbsp;a&nbsp;config&nbsp;file&nbsp;then&nbsp;creating&nbsp;an&nbsp;API&nbsp;object&nbsp;is&nbsp;easy.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;CSIntel<br>
&nbsp;&nbsp;&nbsp;&nbsp;(custid,&nbsp;custkey)&nbsp;=&nbsp;CSIntel.<a href="#-readConfig">readConfig</a>()<br>
&nbsp;&nbsp;&nbsp;&nbsp;api_obj&nbsp;=&nbsp;CSIntel.<a href="#CSIntelAPI">CSIntelAPI</a>(custid,&nbsp;cutkey)<br>
&nbsp;<br>
Now&nbsp;you&nbsp;can&nbsp;search&nbsp;for&nbsp;data&nbsp;-&nbsp;for&nbsp;eample,&nbsp;data&nbsp;on&nbsp;an&nbsp;adversary&nbsp;we've&nbsp;been&nbsp;tracking.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;-&nbsp;api_obj.<a href="#CSIntelAPI-SearchActorEqual">SearchActorEqual</a>("putterpanda")<br>
&nbsp;<br>
And&nbsp;then&nbsp;manipulate&nbsp;the&nbsp;results.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;json.loads(&nbsp;result.text&nbsp;)<br>
&nbsp;<br>
Or&nbsp;use&nbsp;some&nbsp;of&nbsp;the&nbsp;built&nbsp;in&nbsp;methods.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;hashes&nbsp;=&nbsp;api_obj.<a href="#CSIntelAPI-GetHashesFromResults">GetHashesFromResults</a>(data)<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="CSIntelAPI-GetActorsFromResults"><strong>GetActorsFromResults</strong></a>(self, result)</dt><dd><tt>Feed&nbsp;this&nbsp;function&nbsp;the&nbsp;results&nbsp;from&nbsp;an&nbsp;API&nbsp;search&nbsp;and&nbsp;it&nbsp;will&nbsp;return<br>
the&nbsp;name(s)&nbsp;of&nbsp;any&nbsp;threat&nbsp;actors&nbsp;associated&nbsp;with&nbsp;this&nbsp;list&nbsp;of&nbsp;indicators.<br>
If&nbsp;you&nbsp;already&nbsp;have&nbsp;some&nbsp;IPs,&nbsp;or&nbsp;domains,&nbsp;for&nbsp;example,&nbsp;you&nbsp;can&nbsp;use&nbsp;this&nbsp;to<br>
check&nbsp;for&nbsp;attribution.<br>
The&nbsp;function&nbsp;returns&nbsp;a&nbsp;raw&nbsp;list&nbsp;of&nbsp;actor&nbsp;names,&nbsp;you&nbsp;may&nbsp;want&nbsp;to&nbsp;dedupe&nbsp;them.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-GetDomainsFromResults"><strong>GetDomainsFromResults</strong></a>(self, result, related<font color="#909090">=False</font>)</dt><dd><tt>Pass&nbsp;this&nbsp;function&nbsp;results&nbsp;pulled&nbsp;from&nbsp;the&nbsp;API&nbsp;and&nbsp;it&nbsp;will&nbsp;return<br>
any&nbsp;domains&nbsp;that&nbsp;were&nbsp;included&nbsp;in&nbsp;the&nbsp;list&nbsp;of&nbsp;indicators.<br>
The&nbsp;related&nbsp;option&nbsp;will&nbsp;include&nbsp;any&nbsp;indicators&nbsp;that&nbsp;are&nbsp;related<br>
to&nbsp;the&nbsp;primary&nbsp;indicators&nbsp;returned&nbsp;from&nbsp;your&nbsp;API&nbsp;search.<br>
This&nbsp;returns&nbsp;a&nbsp;simple&nbsp;list&nbsp;of&nbsp;domains,&nbsp;one&nbsp;per&nbsp;line.&nbsp;Want&nbsp;to&nbsp;collect<br>
domains&nbsp;to&nbsp;feed&nbsp;into&nbsp;your&nbsp;proxy&nbsp;to&nbsp;block?</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-GetHashesFromResults"><strong>GetHashesFromResults</strong></a>(self, result, related<font color="#909090">=False</font>)</dt><dd><tt>Give&nbsp;this&nbsp;function&nbsp;results&nbsp;from&nbsp;an&nbsp;API&nbsp;query&nbsp;and&nbsp;it&nbsp;will&nbsp;pull&nbsp;out<br>
all&nbsp;of&nbsp;the&nbsp;hashes&nbsp;from&nbsp;indicators&nbsp;in&nbsp;those&nbsp;results&nbsp;and&nbsp;return&nbsp;them&nbsp;as&nbsp;a&nbsp;list<br>
of&nbsp;hashes.<br>
Also&nbsp;takes&nbsp;the&nbsp;option&nbsp;to&nbsp;include&nbsp;indicators&nbsp;from&nbsp;the&nbsp;relations&nbsp;section.&nbsp;This<br>
is&nbsp;off&nbsp;by&nbsp;default.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-GetIPsFromResults"><strong>GetIPsFromResults</strong></a>(self, result, related<font color="#909090">=False</font>)</dt><dd><tt>Pass&nbsp;this&nbsp;function&nbsp;results&nbsp;from&nbsp;an&nbsp;API&nbsp;search&nbsp;and&nbsp;it&nbsp;will&nbsp;return<br>
a&nbsp;list&nbsp;of&nbsp;IP&nbsp;addresses&nbsp;from&nbsp;your&nbsp;list&nbsp;of&nbsp;indicators.<br>
You&nbsp;may&nbsp;optionally&nbsp;include&nbsp;IP&nbsp;indicators&nbsp;identified&nbsp;as&nbsp;related<br>
indicators.<br>
This&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;IP&nbsp;addresses,&nbsp;one&nbsp;per&nbsp;line.&nbsp;Good&nbsp;for&nbsp;collecting<br>
all&nbsp;the&nbsp;IPs&nbsp;you&nbsp;want&nbsp;to&nbsp;feed&nbsp;into&nbsp;your&nbsp;firewall&nbsp;to&nbsp;block.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-GetIndicatorsFromResults"><strong>GetIndicatorsFromResults</strong></a>(self, result, labels<font color="#909090">=True</font>, related<font color="#909090">=False</font>)</dt><dd><tt>Give&nbsp;this&nbsp;function&nbsp;results&nbsp;from&nbsp;an&nbsp;API&nbsp;query&nbsp;and&nbsp;it&nbsp;will&nbsp;pull&nbsp;out<br>
all&nbsp;of&nbsp;the&nbsp;indicators&nbsp;and&nbsp;return&nbsp;them&nbsp;as&nbsp;a&nbsp;list.<br>
The&nbsp;labels&nbsp;option&nbsp;will&nbsp;include&nbsp;all&nbsp;the&nbsp;label&nbsp;strings&nbsp;tied&nbsp;to&nbsp;that&nbsp;<br>
indicator.&nbsp;Each&nbsp;label&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;same&nbsp;line&nbsp;but&nbsp;deliminated<br>
with&nbsp;a&nbsp;colon.&nbsp;This&nbsp;is&nbsp;enabled&nbsp;by&nbsp;default.<br>
This&nbsp;funciton&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;much&nbsp;more&nbsp;verbose&nbsp;with&nbsp;its&nbsp;indicators&nbsp;than<br>
others,&nbsp;since&nbsp;it's&nbsp;returning&nbsp;all&nbsp;types.&nbsp;So&nbsp;this&nbsp;will&nbsp;tell&nbsp;you&nbsp;the&nbsp;type,<br>
the&nbsp;indicator,&nbsp;and&nbsp;any&nbsp;labels.<br>
If&nbsp;you&nbsp;just&nbsp;want&nbsp;the&nbsp;simple&nbsp;list&nbsp;check&nbsp;other&nbsp;funcitons.<br>
Also&nbsp;takes&nbsp;the&nbsp;option&nbsp;to&nbsp;include&nbsp;indicators&nbsp;from&nbsp;the&nbsp;relations&nbsp;section.&nbsp;This<br>
is&nbsp;off&nbsp;by&nbsp;default.&nbsp;These&nbsp;indicators&nbsp;are&nbsp;labeled&nbsp;as&nbsp;related.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-GetReportQuery"><strong>GetReportQuery</strong></a>(self, report, searchFilter, **kwargs)</dt><dd><tt>Build&nbsp;an&nbsp;API&nbsp;query&nbsp;to&nbsp;search&nbsp;by&nbsp;report&nbsp;name.<br>
Must&nbsp;pass&nbsp;it&nbsp;a&nbsp;report&nbsp;name&nbsp;as&nbsp;a&nbsp;string.&nbsp;<br>
I&nbsp;assume&nbsp;searchFilter&nbsp;is&nbsp;equal&nbsp;OR&nbsp;match&nbsp;but&nbsp;come&nbsp;to&nbsp;think&nbsp;of&nbsp;it&nbsp;I've<br>
only&nbsp;tested&nbsp;"equal."<br>
Other&nbsp;keyword&nbsp;arguments&nbsp;can&nbsp;be&nbsp;passed&nbsp;to&nbsp;include&nbsp;sorting&nbsp;etc.&nbsp;<br>
Returns&nbsp;a&nbsp;string&nbsp;for&nbsp;the&nbsp;URL&nbsp;query&nbsp;search.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-GetReportsFromResults"><strong>GetReportsFromResults</strong></a>(self, result)</dt><dd><tt>Pass&nbsp;this&nbsp;funciton&nbsp;results&nbsp;pulled&nbsp;from&nbsp;the&nbsp;API&nbsp;and&nbsp;it&nbsp;will&nbsp;return<br>
any&nbsp;report&nbsp;names&nbsp;associated&nbsp;with&nbsp;the&nbsp;indicators&nbsp;you&nbsp;have.<br>
If&nbsp;you&nbsp;have&nbsp;an&nbsp;indicator&nbsp;or&nbsp;maybe&nbsp;a&nbsp;threat&nbsp;actor&nbsp;you're&nbsp;working&nbsp;with<br>
you&nbsp;can&nbsp;use&nbsp;this&nbsp;to&nbsp;see&nbsp;if&nbsp;there&nbsp;are&nbsp;written&nbsp;reports&nbsp;you&nbsp;should&nbsp;also<br>
check&nbsp;out.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchActorEqual"><strong>SearchActorEqual</strong></a>(self, actor, **kwargs)</dt><dd><tt>A&nbsp;specific&nbsp;use&nbsp;of&nbsp;<a href="#CSIntelAPI-getActorQuery">getActorQuery</a>()&nbsp;to&nbsp;match&nbsp;a&nbsp;specific&nbsp;actor&nbsp;and&nbsp;<br>
perform&nbsp;the&nbsp;search&nbsp;and&nbsp;return&nbsp;the&nbsp;results&nbsp;found.<br>
Any&nbsp;other&nbsp;keywords&nbsp;passed&nbsp;to&nbsp;the&nbsp;function&nbsp;will&nbsp;be&nbsp;encoded&nbsp;in&nbsp;the&nbsp;<br>
URL&nbsp;request&nbsp;-&nbsp;in&nbsp;case&nbsp;you&nbsp;want&nbsp;to&nbsp;filter&nbsp;or&nbsp;sort,&nbsp;for&nbsp;example.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchActorMatch"><strong>SearchActorMatch</strong></a>(self, actor, **kwargs)</dt><dd><tt>A&nbsp;specific&nbsp;use&nbsp;of&nbsp;<a href="#CSIntelAPI-getActorQuery">getActorQuery</a>()&nbsp;to&nbsp;match&nbsp;actors&nbsp;matching&nbsp;a&nbsp;pattern.<br>
The&nbsp;API&nbsp;will&nbsp;be&nbsp;queried&nbsp;and&nbsp;will&nbsp;return&nbsp;the&nbsp;results&nbsp;found.<br>
Any&nbsp;other&nbsp;keywords&nbsp;passed&nbsp;to&nbsp;the&nbsp;function&nbsp;will&nbsp;be&nbsp;encoded&nbsp;in&nbsp;the&nbsp;<br>
URL&nbsp;request&nbsp;-&nbsp;in&nbsp;case&nbsp;you&nbsp;want&nbsp;to&nbsp;filter&nbsp;or&nbsp;sort,&nbsp;for&nbsp;example.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchDomain"><strong>SearchDomain</strong></a>(self, domain)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;a&nbsp;domain</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchHash"><strong>SearchHash</strong></a>(self, myhash)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;a&nbsp;file&nbsp;hash.&nbsp;<br>
The&nbsp;function&nbsp;will&nbsp;use&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;hash&nbsp;string&nbsp;to&nbsp;limit&nbsp;the&nbsp;API<br>
query&nbsp;to&nbsp;a&nbsp;specific&nbsp;type&nbsp;of&nbsp;hash&nbsp;(i.e.&nbsp;MD5,&nbsp;SHA-1,&nbsp;SHA-256.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchIP"><strong>SearchIP</strong></a>(self, ip)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;an&nbsp;IP&nbsp;address</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchIndicatorEqual"><strong>SearchIndicatorEqual</strong></a>(self, indicator, **kwargs)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;an&nbsp;indicator.<br>
Any&nbsp;other&nbsp;keyword&nbsp;arguments&nbsp;passed&nbsp;here&nbsp;will&nbsp;be&nbsp;encoded&nbsp;in&nbsp;the&nbsp;URL</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchIndicatorMatch"><strong>SearchIndicatorMatch</strong></a>(self, indicator, **kwargs)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;an&nbsp;indicator&nbsp;pattern.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchLastDay"><strong>SearchLastDay</strong></a>(self, **kwargs)</dt><dd><tt>Pull&nbsp;any&nbsp;Intel&nbsp;data&nbsp;that&nbsp;has&nbsp;been&nbsp;updated&nbsp;in&nbsp;the&nbsp;last&nbsp;24&nbsp;hours</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchLastUpdated"><strong>SearchLastUpdated</strong></a>(self, date, searchFilter<font color="#909090">='gte'</font>, **kwargs)</dt><dd><tt>Get&nbsp;API&nbsp;updates&nbsp;before&nbsp;or&nbsp;after&nbsp;the&nbsp;date&nbsp;specified&nbsp;and&nbsp;return&nbsp;the&nbsp;results<br>
Extra&nbsp;keyword&nbsp;arguments&nbsp;are&nbsp;passed&nbsp;so&nbsp;you&nbsp;can&nbsp;sort,&nbsp;etc.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchLastWeek"><strong>SearchLastWeek</strong></a>(self, **kwargs)</dt><dd><tt>Pull&nbsp;any&nbsp;Intel&nbsp;data&nbsp;that&nbsp;has&nbsp;been&nbsp;updated&nbsp;in&nbsp;the&nbsp;last&nbsp;week.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchMutex"><strong>SearchMutex</strong></a>(self, mutex)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;a&nbsp;Mutex&nbsp;name</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-SearchReport"><strong>SearchReport</strong></a>(self, report, searchFilter<font color="#909090">='equal'</font>, **kwargs)</dt><dd><tt>Search&nbsp;the&nbsp;API&nbsp;for&nbsp;a&nbsp;specific&nbsp;report.<br>
Pass&nbsp;the&nbsp;report&nbsp;name&nbsp;as&nbsp;a&nbsp;string,&nbsp;and&nbsp;any&nbsp;other&nbsp;options.<br>
Returns&nbsp;the&nbsp;results&nbsp;of&nbsp;the&nbsp;API&nbsp;query.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-__init__"><strong>__init__</strong></a>(self, custid<font color="#909090">=None</font>, custkey<font color="#909090">=None</font>)</dt><dd><tt>Intit&nbsp;funciton&nbsp;for&nbsp;the&nbsp;CS&nbsp;Intel&nbsp;API&nbsp;object&nbsp;-&nbsp;pass&nbsp;it&nbsp;the&nbsp;API&nbsp;customer&nbsp;ID&nbsp;and<br>
customer&nbsp;key&nbsp;to&nbsp;create&nbsp;it.&nbsp;<br>
Optional:&nbsp;whether&nbsp;the&nbsp;config&nbsp;should&nbsp;be&nbsp;written&nbsp;to&nbsp;disk&nbsp;as&nbsp;a&nbsp;config&nbsp;ini&nbsp;file.&nbsp;<br>
If&nbsp;the&nbsp;config&nbsp;file&nbsp;is&nbsp;being&nbsp;used&nbsp;check&nbsp;out&nbsp;the&nbsp;<a href="#-readConfig">readConfig</a>()&nbsp;function&nbsp;to&nbsp;grab<br>
those&nbsp;fields&nbsp;before&nbsp;creating&nbsp;this&nbsp;object.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-getActorQuery"><strong>getActorQuery</strong></a>(self, actor, searchFilter<font color="#909090">='equal'</font>, **kwargs)</dt><dd><tt>A&nbsp;specific&nbsp;API&nbsp;query&nbsp;-&nbsp;provide&nbsp;an&nbsp;actor&nbsp;name&nbsp;to&nbsp;retrieve&nbsp;data&nbsp;<br>
on&nbsp;that&nbsp;actor&nbsp;from&nbsp;the&nbsp;intel&nbsp;API.&nbsp;<br>
First&nbsp;optional&nbsp;argument&nbsp;is&nbsp;"searchFilter"&nbsp;which&nbsp;defaults&nbsp;to<br>
"equal"&nbsp;for&nbsp;an&nbsp;exact&nbsp;match&nbsp;(e.g.&nbsp;Putter&nbsp;Panda)&nbsp;but&nbsp;you&nbsp;can&nbsp;use<br>
searchFilter="match"&nbsp;instead&nbsp;to&nbsp;search&nbsp;for&nbsp;a&nbsp;pattern&nbsp;(e.g.&nbsp;<br>
panda).<br>
Any&nbsp;other&nbsp;keywords&nbsp;passed&nbsp;to&nbsp;the&nbsp;function&nbsp;will&nbsp;be&nbsp;encoded&nbsp;in&nbsp;the<br>
URL&nbsp;request&nbsp;-&nbsp;in&nbsp;case&nbsp;you&nbsp;want&nbsp;to&nbsp;filter&nbsp;or&nbsp;sort,&nbsp;for&nbsp;example.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-getEpochDaysAgo"><strong>getEpochDaysAgo</strong></a>(self, days)</dt><dd><tt>Pass&nbsp;this&nbsp;function&nbsp;an&nbsp;interger&nbsp;n&nbsp;and&nbsp;this&nbsp;function&nbsp;will&nbsp;return<br>
the&nbsp;epoc&nbsp;time&nbsp;for&nbsp;n&nbsp;days&nbsp;ago.<br>
<a href="#CSIntelAPI-getEpochDaysAgo">getEpochDaysAgo</a>(1),&nbsp;for&nbsp;example,&nbsp;returns&nbsp;the&nbsp;epoch&nbsp;time&nbsp;for&nbsp;<br>
yesterday&nbsp;(24&nbsp;hours&nbsp;ago).</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-getHeaders"><strong>getHeaders</strong></a>(self)</dt><dd><tt>Need&nbsp;to&nbsp;pass&nbsp;customer&nbsp;id&nbsp;and&nbsp;key&nbsp;as&nbsp;headers.<br>
This&nbsp;will&nbsp;return&nbsp;the&nbsp;correct&nbsp;syntax&nbsp;to&nbsp;do&nbsp;so.&nbsp;These&nbsp;fields&nbsp;need&nbsp;to&nbsp;be<br>
passed&nbsp;as&nbsp;headers&nbsp;and&nbsp;not&nbsp;in&nbsp;the&nbsp;URL&nbsp;request&nbsp;itself.&nbsp;<br>
headers&nbsp;=&nbsp;{'X-CSIX-CUSTID':&nbsp;custid,&nbsp;'X-CSIX-CUSTKEY':&nbsp;custkey}</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-getIndicatorQuery"><strong>getIndicatorQuery</strong></a>(self, indicator, searchFilter<font color="#909090">='equal'</font>, **kwargs)</dt><dd><tt>This&nbsp;function&nbsp;builds&nbsp;a&nbsp;URL&nbsp;query&nbsp;to&nbsp;search&nbsp;for&nbsp;an&nbsp;indicator.&nbsp;The<br>
indicator&nbsp;string&nbsp;is&nbsp;what&nbsp;to&nbsp;search&nbsp;for.&nbsp;The&nbsp;searchFilter&nbsp;allows&nbsp;you<br>
specific&nbsp;match&nbsp;or&nbsp;equal.&nbsp;Any&nbsp;other&nbsp;keyword&nbsp;attributes&nbsp;passed&nbsp;will&nbsp;also<br>
be&nbsp;encoded&nbsp;as&nbsp;parameters.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-getLastUpdatedQuery"><strong>getLastUpdatedQuery</strong></a>(self, date, searchFilter, **kwargs)</dt><dd><tt>Build&nbsp;a&nbsp;query&nbsp;to&nbsp;get&nbsp;changes&nbsp;before/after&nbsp;date&nbsp;argument<br>
The&nbsp;searchfilter&nbsp;defaults&nbsp;to&nbsp;greater&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;the&nbsp;time&nbsp;passed.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-getURLParams"><strong>getURLParams</strong></a>(self, **kwargs)</dt><dd><tt>This&nbsp;funciton&nbsp;takes&nbsp;a&nbsp;series&nbsp;of&nbsp;keyword&nbsp;arguments&nbsp;and&nbsp;then<br>
encodes&nbsp;them&nbsp;all&nbsp;in&nbsp;a&nbsp;single&nbsp;URL&nbsp;string.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-request"><strong>request</strong></a>(self, query)</dt><dd><tt>This&nbsp;function&nbsp;was&nbsp;intended&nbsp;as&nbsp;an&nbsp;internal&nbsp;method&nbsp;-&nbsp;it&nbsp;just&nbsp;takes&nbsp;the&nbsp;query&nbsp;<br>
you&nbsp;pass&nbsp;it&nbsp;and&nbsp;sends&nbsp;it&nbsp;to&nbsp;the&nbsp;API&nbsp;along&nbsp;with&nbsp;your&nbsp;API&nbsp;ID&nbsp;&amp;&nbsp;Key.&nbsp;If&nbsp;you&nbsp;<br>
know&nbsp;the&nbsp;API&nbsp;or&nbsp;rest&nbsp;real&nbsp;well&nbsp;have&nbsp;at&nbsp;it.</tt></dd></dl>

<dl><dt><a name="CSIntelAPI-writeConfig"><strong>writeConfig</strong></a>(self, fileName<font color="#909090">=None</font>)</dt><dd><tt>This&nbsp;script&nbsp;supports&nbsp;reading&nbsp;the&nbsp;API&nbsp;config&nbsp;data&nbsp;from&nbsp;a<br>
configuration&nbsp;file&nbsp;instead&nbsp;of&nbsp;passing&nbsp;it&nbsp;as&nbsp;CLI&nbsp;options.<br>
That&nbsp;file&nbsp;can&nbsp;easily&nbsp;be&nbsp;written&nbsp;manually,&nbsp;but&nbsp;if&nbsp;you&nbsp;use<br>
this&nbsp;script&nbsp;it&nbsp;can&nbsp;also&nbsp;write&nbsp;the&nbsp;config&nbsp;file&nbsp;from&nbsp;the&nbsp;options<br>
you&nbsp;have&nbsp;loaded.</tt></dd></dl>

</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-readConfig"><strong>readConfig</strong></a>(fileName<font color="#909090">=None</font>)</dt><dd><tt>this&nbsp;method&nbsp;is&nbsp;usef&nbsp;for&nbsp;initial&nbsp;creation&nbsp;and&nbsp;can&nbsp;be&nbsp;called<br>
before&nbsp;an&nbsp;API&nbsp;object&nbsp;is&nbsp;created.&nbsp;Just&nbsp;pass&nbsp;it&nbsp;the&nbsp;filename<br>
to&nbsp;read&nbsp;an&nbsp;existing&nbsp;config&nbsp;file.</tt></dd></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>CSconfigSection</strong> = 'CrowdStrikeIntelAPI'<br>
<strong>__author__</strong> = 'Adam Hogan'<br>
<strong>__email__</strong> = 'adam.hogan@crowdstrike.com'<br>
<strong>__version__</strong> = 0.3<br>
<strong>defaultConfigFileName</strong> = 'csintel.ini'<br>
<strong>host</strong> = 'https://intelapi.crowdstrike.com/indicator/v1/search/'<br>
<strong>validConfidence</strong> = ['high', 'medium', 'low', 'unverified']<br>
<strong>validDomainType</strong> = ['Actor Controlled', 'DGA', 'DynamicDNS', 'DynamicDNS/Afraid', 'DynamicDNS/DYN', 'DynamicDNS/Hostinger', 'DynamicDNS/noIP', 'DynamicDNS/Oray', 'KnownGood', 'LegitimateCompromised', 'PhishingDomain', 'Sinkholed', 'StragegicWebCompromise', 'Unregistered']<br>
<strong>validFilter</strong> = ['match', 'equal', 'gt', 'gte', 'lt', 'lte']<br>
<strong>validParameter</strong> = ['sort', 'order', 'last_updated', 'perPage', 'page']<br>
<strong>validSearch</strong> = ['indicator', 'actor', 'report', 'actor', 'malicious_confidence', 'published_date', 'last_updated', 'malware_family', 'kill_chain', 'domain_type']<br>
<strong>validSort</strong> = ['indicator', 'type', 'report', 'actor', 'malicious_confidence', 'published_date', 'last_updated']<br>
<strong>validType</strong> = ['binary_string', 'compile_time', 'device_name', 'domain', 'email_address', 'email_subject', 'event_name', 'file_mapping', 'file_name', 'file_path', 'hash_ion', 'hash_md5', 'hash_sha1', 'hash_sha256', 'ip_address', 'ip_address_block', 'mutex_name', 'password', 'persona_name', 'phone_number', ...]</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#7799ee">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Author</strong></big></font></td></tr>
    
<tr><td bgcolor="#7799ee"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%">Adam&nbsp;Hogan</td></tr></table>
</body></html>